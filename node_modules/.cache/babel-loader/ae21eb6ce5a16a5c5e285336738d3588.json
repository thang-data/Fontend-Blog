{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/nguye/Desktop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/nguye/Desktop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useRef,useCallback}from'react';import ReactQuill from'react-quill';import'react-quill/dist/quill.snow.css';import{useDispatch}from'react-redux';import{checkImage,imageUpload}from'../../utils/ImageUpload';import{ALERT}from'../../redux/types/alertType';import{jsx as _jsx}from\"react/jsx-runtime\";var Quill=function Quill(_ref){var setBody=_ref.setBody,body=_ref.body;var dispatch=useDispatch();var quillRef=useRef(null);var modules={toolbar:{container:container}};// Custom image\nvar handleChangeImage=useCallback(function(){var input=document.createElement('input');input.type=\"file\";input.accept=\"image/*\";input.click();input.onchange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _quill$getEditor$getS;var files,file,check,photo,quill,range;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:files=input.files;if(files){_context.next=3;break;}return _context.abrupt(\"return\",dispatch({type:ALERT,payload:{errors:'File does not exist.'}}));case 3:file=files[0];check=checkImage(file);if(!check){_context.next=7;break;}return _context.abrupt(\"return\",dispatch({type:ALERT,payload:{errors:check}}));case 7:dispatch({type:ALERT,payload:{loading:true}});_context.next=10;return imageUpload(file);case 10:photo=_context.sent;quill=quillRef.current;range=quill===null||quill===void 0?void 0:(_quill$getEditor$getS=quill.getEditor().getSelection())===null||_quill$getEditor$getS===void 0?void 0:_quill$getEditor$getS.index;if(range!==undefined){quill===null||quill===void 0?void 0:quill.getEditor().insertEmbed(range,'image',\"\".concat(photo.url));}dispatch({type:ALERT,payload:{loading:false}});case 15:case\"end\":return _context.stop();}}},_callee);}));},[dispatch]);useEffect(function(){var quill=quillRef.current;if(!quill)return;var toolbar=quill.getEditor().getModule('toolbar');toolbar.addHandler('image',handleChangeImage);},[handleChangeImage]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(ReactQuill,{theme:\"snow\",modules:modules,placeholder:\"Write somethings...\",onChange:function onChange(e){return setBody(e);},value:body,ref:quillRef})});};var container=[[{'font':[]}],[{'header':[1,2,3,4,5,6,false]}],[{'size':['small',false,'large','huge']}],// custom dropdown\n['bold','italic','underline','strike'],// toggled buttons\n['blockquote','code-block'],[{'color':[]},{'background':[]}],// dropdown with defaults from theme\n[{'script':'sub'},{'script':'super'}],// superscript/subscript\n[{'list':'ordered'},{'list':'bullet'}],[{'indent':'-1'},{'indent':'+1'}],// outdent/indent\n[{'direction':'rtl'}],// text direction\n[{'align':[]}],['clean','link','image','video']];export default Quill;","map":{"version":3,"sources":["C:/Users/nguye/Desktop/client/src/components/editor/ReactQuill.tsx"],"names":["React","useEffect","useRef","useCallback","ReactQuill","useDispatch","checkImage","imageUpload","ALERT","Quill","setBody","body","dispatch","quillRef","modules","toolbar","container","handleChangeImage","input","document","createElement","type","accept","click","onchange","files","payload","errors","file","check","loading","photo","quill","current","range","getEditor","getSelection","index","undefined","insertEmbed","url","getModule","addHandler","e"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useCallback } from 'react'\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\n\nimport { useDispatch } from 'react-redux'\n\nimport { checkImage, imageUpload } from '../../utils/ImageUpload'\nimport { ALERT } from '../../redux/types/alertType'\n\ninterface IProps {\n  setBody: (value: string) => void\n  body: string\n}\n\nconst Quill: React.FC<IProps> = ({setBody, body}) => {\n  const dispatch = useDispatch()\n  const quillRef = useRef<ReactQuill>(null)\n\n  const modules = { toolbar: { container }}\n\n  // Custom image\n  const handleChangeImage = useCallback(() => {\n    const input = document.createElement('input')\n    input.type = \"file\"\n    input.accept = \"image/*\"\n    input.click()\n\n    input.onchange = async () => {\n      const files = input.files\n      if(!files) return dispatch({\n        type: ALERT, payload: { errors: 'File does not exist.'}\n      });\n\n      const file = files[0]\n      const check = checkImage(file)\n      if(check) return dispatch({ type: ALERT, payload: { errors: check } });\n      \n      dispatch({ type: ALERT, payload: { loading: true } })\n      const photo = await imageUpload(file)\n\n      const quill = quillRef.current;\n      const range = quill?.getEditor().getSelection()?.index\n      if(range !== undefined){\n        quill?.getEditor().insertEmbed(range, 'image', `${photo.url}`)\n      }\n\n      dispatch({ type: ALERT, payload: { loading: false } })\n    }\n  },[dispatch])\n\n\n  useEffect(() => {\n    const quill = quillRef.current;\n    if(!quill) return;\n\n    let toolbar = quill.getEditor().getModule('toolbar')\n    toolbar.addHandler('image', handleChangeImage)\n  },[handleChangeImage])\n\n  return (\n    <div>\n      <ReactQuill theme=\"snow\"\n      modules={modules}\n      placeholder=\"Write somethings...\"\n      onChange={e => setBody(e)}\n      value={body}\n      ref={quillRef} />\n    </div>\n  )\n}\n\nlet container = [\n  [{ 'font': [] }],\n  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n  [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown\n\n  ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n  ['blockquote', 'code-block'],\n  [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n  [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript\n\n  [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n  [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent\n  [{ 'direction': 'rtl' }],                         // text direction\n  [{ 'align': [] }],\n\n  ['clean', 'link', 'image','video']\n]\n\nexport default Quill\n"]},"metadata":{},"sourceType":"module"}