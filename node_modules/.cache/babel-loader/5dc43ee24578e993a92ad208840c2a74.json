{"ast":null,"code":"import _objectSpread from\"C:/Users/nguye/Desktop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/nguye/Desktop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/nguye/Desktop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useDispatch,useSelector}from'react-redux';import{replyComment,updateComment,deleteComment}from'../../redux/actions/commentAction';import Input from'./Input';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentList=function CommentList(_ref){var _auth$user,_auth$user2;var children=_ref.children,comment=_ref.comment,showReply=_ref.showReply,setShowReply=_ref.setShowReply;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),onReply=_useState2[0],setOnReply=_useState2[1];var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth;var dispatch=useDispatch();var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),edit=_useState4[0],setEdit=_useState4[1];var handleReply=function handleReply(body){if(!auth.user||!auth.access_token)return;var data={user:auth.user,blog_id:comment.blog_id,blog_user_id:comment.blog_user_id,content:body,replyCM:[],reply_user:comment.user,comment_root:comment.comment_root||comment._id,createdAt:new Date().toISOString()};setShowReply([data].concat(_toConsumableArray(showReply)));dispatch(replyComment(data,auth.access_token));setOnReply(false);};var handleUpdate=function handleUpdate(body){if(!auth.user||!auth.access_token||!edit)return;if(body===edit.content)return setEdit(undefined);var newComment=_objectSpread(_objectSpread({},edit),{},{content:body});dispatch(updateComment(newComment,auth.access_token));setEdit(undefined);};var handleDelete=function handleDelete(comment){if(!auth.user||!auth.access_token)return;dispatch(deleteComment(comment,auth.access_token));};var Nav=function Nav(comment){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash-alt mx-2\",onClick:function onClick(){return handleDelete(comment);}}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit me-2\",onClick:function onClick(){return setEdit(comment);}})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-100\",children:[edit?/*#__PURE__*/_jsx(Input,{callback:handleUpdate,edit:edit,setEdit:setEdit}):/*#__PURE__*/_jsxs(\"div\",{className:\"comment_box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2\",dangerouslySetInnerHTML:{__html:comment.content}}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between p-2\",children:[/*#__PURE__*/_jsx(\"small\",{style:{cursor:'pointer'},onClick:function onClick(){return setOnReply(!onReply);},children:onReply?'- Cancel -':'- Reply -'}),/*#__PURE__*/_jsxs(\"small\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"comment_nav\",children:comment.blog_user_id===((_auth$user=auth.user)===null||_auth$user===void 0?void 0:_auth$user._id)?comment.user._id===auth.user._id?Nav(comment):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash-alt mx-2\",onClick:function onClick(){return handleDelete(comment);}}):comment.user._id===((_auth$user2=auth.user)===null||_auth$user2===void 0?void 0:_auth$user2._id)&&Nav(comment)}),/*#__PURE__*/_jsx(\"div\",{children:new Date(comment.createdAt).toLocaleString()})]})]})]}),onReply&&/*#__PURE__*/_jsx(Input,{callback:handleReply}),children]});};export default CommentList;","map":{"version":3,"sources":["C:/Users/nguye/Desktop/client/src/components/comments/CommentList.tsx"],"names":["React","useState","useDispatch","useSelector","replyComment","updateComment","deleteComment","Input","CommentList","children","comment","showReply","setShowReply","onReply","setOnReply","state","auth","dispatch","edit","setEdit","handleReply","body","user","access_token","data","blog_id","blog_user_id","content","replyCM","reply_user","comment_root","_id","createdAt","Date","toISOString","handleUpdate","undefined","newComment","handleDelete","Nav","__html","cursor","toLocaleString"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport { IComment, RootStore } from '../../utils/TypeScript'\n\nimport { \n  replyComment, \n  updateComment,\n  deleteComment\n} from '../../redux/actions/commentAction'\n\nimport Input from './Input'\n\ninterface IProps {\n  comment: IComment\n  showReply: IComment[]\n  setShowReply: (showReply: IComment[]) => void\n}\n\nconst CommentList: React.FC<IProps> = ({ \n  children, comment, showReply, setShowReply\n}) => {\n  const [onReply, setOnReply] = useState(false)\n  const { auth } = useSelector((state: RootStore) => state)\n  const dispatch = useDispatch()\n\n  const [edit, setEdit] = useState<IComment>()\n\n  const handleReply = (body: string) => {\n    if(!auth.user || !auth.access_token) return;\n\n    const data = {\n      user: auth.user,\n      blog_id: comment.blog_id,\n      blog_user_id: comment.blog_user_id,\n      content: body,\n      replyCM: [],\n      reply_user: comment.user,\n      comment_root: comment.comment_root || comment._id,\n      createdAt: new Date().toISOString()\n    }\n\n\n    setShowReply([data, ...showReply])\n    dispatch(replyComment(data, auth.access_token))\n    setOnReply(false)\n  }\n\n\n  const handleUpdate = (body: string) => {\n    if(!auth.user || !auth.access_token || !edit) return;\n\n    if(body === edit.content) \n      return setEdit(undefined)\n    \n    const newComment = {...edit, content: body}\n    dispatch(updateComment(newComment, auth.access_token))\n    setEdit(undefined)\n  }\n\n  const handleDelete = (comment: IComment) => {\n    if(!auth.user || !auth.access_token) return;\n    dispatch(deleteComment(comment, auth.access_token))\n  }\n\n\n  const Nav = (comment: IComment) => {\n    return(\n      <div>\n        <i className=\"fas fa-trash-alt mx-2\"\n        onClick={() => handleDelete(comment)} />\n\n        <i className=\"fas fa-edit me-2\"\n        onClick={() => setEdit(comment)} />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"w-100\">\n      {\n        edit\n        ? <Input \n          callback={handleUpdate} \n          edit={edit}\n          setEdit={setEdit}\n        />\n\n        : <div className=\"comment_box\">\n            <div className=\"p-2\" dangerouslySetInnerHTML={{\n              __html: comment.content\n            }} />\n\n            <div className=\"d-flex justify-content-between p-2\">\n              <small style={{cursor: 'pointer'}}\n              onClick={() => setOnReply(!onReply)}>\n                {onReply ? '- Cancel -' :'- Reply -'}\n              </small>\n\n              <small className=\"d-flex\">\n                <div className=\"comment_nav\">\n                  {\n                    comment.blog_user_id === auth.user?._id\n                    ? comment.user._id === auth.user._id\n                      ? Nav(comment)\n                      : <i className=\"fas fa-trash-alt mx-2\"\n                      onClick={() => handleDelete(comment)} />\n                    : comment.user._id === auth.user?._id && Nav(comment)\n                  }\n                </div>\n\n                <div>\n                  { new Date(comment.createdAt).toLocaleString() }\n                </div>\n              </small>\n            </div>\n\n          </div>\n      }\n\n      {\n        onReply && <Input callback={handleReply} />\n      }\n      \n      { children }\n    </div>\n  )\n}\n\nexport default CommentList\n"]},"metadata":{},"sourceType":"module"}