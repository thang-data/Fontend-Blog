{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nguye\\\\Desktop\\\\client\\\\src\\\\components\\\\blog\\\\DisplayBlog.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useHistory } from 'react-router-dom';\nimport Input from '../comments/Input';\nimport Comments from '../comments/Comments';\nimport Loading from '../global/Loading';\nimport Pagination from '../global/Pagination';\nimport { createComment, getComments } from '../../redux/actions/commentAction';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst DisplayBlog = ({\n  blog\n}) => {\n  _s();\n\n  const {\n    auth,\n    comments\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const [showComments, setShowComments] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n\n  const handleComment = body => {\n    if (!auth.user || !auth.access_token) return;\n    const data = {\n      content: body,\n      user: auth.user,\n      blog_id: blog._id,\n      blog_user_id: blog.user._id,\n      replyCM: [],\n      createdAt: new Date().toISOString()\n    };\n    setShowComments([data, ...showComments]);\n    dispatch(createComment(data, auth.access_token));\n  };\n\n  useEffect(() => {\n    setShowComments(comments.data);\n  }, [comments.data]);\n  const fetchComments = useCallback(async (id, num = 1) => {\n    setLoading(true);\n    await dispatch(getComments(id, num));\n    setLoading(false);\n  }, [dispatch]);\n  useEffect(() => {\n    if (!blog._id) return;\n    const num = history.location.search.slice(6) || 1;\n    fetchComments(blog._id, num);\n  }, [blog._id, fetchComments, history]);\n\n  const handlePagination = num => {\n    if (!blog._id) return;\n    fetchComments(blog._id, num);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-center my-3 text-capitalize fs-1\",\n      style: {\n        color: '#ff7a00'\n      },\n      children: blog.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-end fst-italic\",\n      style: {\n        color: 'teal'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"small\", {\n        children: typeof blog.user !== 'string' && `By: ${blog.user.name}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        className: \"ms-2\",\n        children: new Date(blog.createdAt).toLocaleString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: blog.content\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"my-1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        color: '#ff7a00'\n      },\n      children: \"\\u2729 Comments \\u2729\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), auth.user ? /*#__PURE__*/_jsxDEV(Input, {\n      callback: handleComment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: [\"Please \", /*#__PURE__*/_jsxDEV(Link, {\n        to: `/login?blog/${blog._id}`,\n        children: \"login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 18\n      }, this), \" to comment.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }, this) : showComments === null || showComments === void 0 ? void 0 : showComments.map((comment, index) => /*#__PURE__*/_jsxDEV(Comments, {\n      comment: comment\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }, this)), comments.total > 1 && /*#__PURE__*/_jsxDEV(Pagination, {\n      total: comments.total,\n      callback: handlePagination\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n\n_s(DisplayBlog, \"GBTn+wrGjvlL16031wfhr+nBatY=\", false, function () {\n  return [useSelector, useDispatch, useHistory];\n});\n\n_c = DisplayBlog;\nexport default DisplayBlog;\n\nvar _c;\n\n$RefreshReg$(_c, \"DisplayBlog\");","map":{"version":3,"sources":["C:/Users/nguye/Desktop/client/src/components/blog/DisplayBlog.tsx"],"names":["React","useState","useEffect","useCallback","useDispatch","useSelector","Link","useHistory","Input","Comments","Loading","Pagination","createComment","getComments","DisplayBlog","blog","auth","comments","state","dispatch","showComments","setShowComments","loading","setLoading","history","handleComment","body","user","access_token","data","content","blog_id","_id","blog_user_id","replyCM","createdAt","Date","toISOString","fetchComments","id","num","location","search","slice","handlePagination","color","title","name","toLocaleString","__html","map","comment","index","total"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link, useHistory } from 'react-router-dom'\n\nimport { IBlog, RootStore, IUser, IComment } from '../../utils/TypeScript'\n\nimport Input from '../comments/Input'\nimport Comments from '../comments/Comments'\nimport Loading from '../global/Loading'\nimport Pagination from '../global/Pagination'\n\nimport { \n  createComment, \n  getComments \n} from '../../redux/actions/commentAction'\n\n\ninterface IProps {\n  blog: IBlog\n}\n\nconst DisplayBlog: React.FC<IProps> = ({blog}) => {\n  const { auth, comments } = useSelector((state: RootStore) => state)\n  const dispatch = useDispatch()\n\n  const [showComments, setShowComments] = useState<IComment[]>([])\n  const [loading, setLoading] = useState(false)\n\n  const history = useHistory()\n\n\n  const handleComment = (body: string) => {\n    if(!auth.user || !auth.access_token) return;\n\n    const data = {\n      content: body,\n      user: auth.user,\n      blog_id: (blog._id as string),\n      blog_user_id: (blog.user as IUser)._id,\n      replyCM: [],\n      createdAt: new Date().toISOString()\n    }\n\n    setShowComments([data, ...showComments])\n    dispatch(createComment(data, auth.access_token))\n  }\n\n\n  useEffect(() => {\n    setShowComments(comments.data)\n  },[comments.data])\n\n\n  const fetchComments = useCallback(async(id: string, num = 1) => {\n    setLoading(true)\n    await dispatch(getComments(id, num))\n    setLoading(false)\n  },[dispatch])\n\n\n  useEffect(() => {\n    if(!blog._id) return;\n    const num = history.location.search.slice(6) || 1;\n    fetchComments(blog._id, num)\n  },[blog._id, fetchComments, history])\n\n  const handlePagination = (num: number) => {\n    if(!blog._id) return;\n    fetchComments(blog._id, num)\n  }\n\n\n  return (\n    <div>\n      <h2 className=\"text-center my-3 text-capitalize fs-1\"\n      style={{ color: '#ff7a00' }}>\n        {blog.title}\n      </h2>\n\n      <div className=\"text-end fst-italic\" style={{color: 'teal'}}>\n        <small>\n          {\n            typeof(blog.user) !== 'string' &&\n            `By: ${blog.user.name}`\n          }\n        </small>\n\n        <small className=\"ms-2\">\n          { new Date(blog.createdAt).toLocaleString() }\n        </small>\n      </div>\n\n      <div dangerouslySetInnerHTML={{\n        __html: blog.content\n      }} />\n\n      <hr className=\"my-1\" />\n      <h3 style={{color: '#ff7a00'}}>✩ Comments ✩</h3>\n\n      {\n        auth.user\n        ? <Input callback={handleComment} />\n        : <h5>\n          Please <Link to={`/login?blog/${blog._id}`}>login</Link> to comment.\n        </h5>\n      }\n      \n      {\n        loading\n        ? <Loading />\n        : showComments?.map((comment, index) => (\n          <Comments key={index} comment={comment} />\n        ))\n      }\n\n      {\n        comments.total > 1 &&\n        <Pagination \n        total={comments.total}\n        callback={handlePagination}\n        />\n      }\n    </div>\n  )\n}\n\nexport default DisplayBlog\n"]},"metadata":{},"sourceType":"module"}